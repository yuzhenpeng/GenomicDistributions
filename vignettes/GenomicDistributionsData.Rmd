---
title: "Full-size data from GenomicDistributionsData"
author: "Michal Stolarczyk"
date: "2020-05-22"
output: 
  BiocStyle::html_document:
    toc: true
vignette: >
  %\VignetteIndexEntry{3. Full-size data from GenomicDistributionsData}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---



# Introduction

The point of this vignette is to demonstrate the seamless usage of our companion package: `GenomicDistributionsData` as a source of reference data sets that are not included in `GenomicDistributions`.

## Motivation

The `GenomicDistributions` package comes with build-in reference data sets to perform calculations for human hg19 genome. 

To use `GenomicDistributions` with other reference genomes you need to install our companion package with more full-size data: `GenomicDistributionsData`. It's currently hosted on our server.


```r
install.packages("http://big.databio.org/GenomicDistributionsData/GenomicDistributionsData_0.0.1.tar.gz", repos=NULL)
```

## `GenomicDistributionsData` contents

This package provides the following data:


```r
library(GenomicDistributions)
library(GenomicDistributionsData)
datasetListIQR = utils::data(package="GenomicDistributionsData")
datasetList = datasetListIQR$results[,"Item"]
datasetList
```

```
## [1] "TSS_hg19"              "TSS_hg38"              "chromSizes_hg19"      
## [4] "chromSizes_hg38"       "geneModels_hg19"       "geneModels_hg38"      
## [7] "openSignalMatrix_hg19" "openSignalMatrix_hg38"
```

# Usage

With the package loaded we have access to the required files for more genomes, namely:

* hg38
* hg19
* mm10
* mm9

Let's calculate some statistics and create plot for an hg38 BED file example. First, let's download one and read into R workspace:


```r
if (basename(getwd()) != "long_vignettes") setwd("long_vignettes")  # run from GenomicDistributions/long_vignettes
message(getwd())
bfc = BiocFileCache::BiocFileCache(getwd())
rpath = function(url, bfc) {
	# Utility function so we can lapply the data loading across a list.
	message("Downloading ", url)
	BiocFileCache::bfcrpath(bfc, url)
}

url = c(A549_H3K27ac="https://ftp.ncbi.nlm.nih.gov/geo/samples/GSM2421nnn/GSM2421593/suppl/GSM2421593_ENCFF715EXP_peaks_GRCh38.bed.gz")
filename = BiocFileCache::bfcrpath(bfc, url)
query = rtracklayer::import(filename, extraCols=c(signalValue = "numeric", pValue = "numeric", qValue = "numeric", peak = "integer"))
```



```r
# First, calculate the distribution:
x = calcChromBinsRef(query, "hg38")

# Then, plot the result:
plotChromBins(x)
```

![Chromosome distribution plots.](figures-GDData/chrom-plots-single-1.png)

The functions work with "hg38" as the reference. `GenomicDistributions` used required reference data sets from `GenomicDistributionsData` behind the scenes.

Importantly, using `GenomicDistributionsData` package you can perform calculations that were not possible before, since one of the inputs to `calcOpenSignal` function is a large matrix. Now, you just need to load in into the workspace, like this:


```r
data(openSignalMatrix_hg38)
op = calcOpenSignal(query, openSignalMatrix_hg38)
plotOpenSignal(op)
```

![Specificity of chromatin accessibility across cell types.](figures-GDData/specificity-plot-single-1.png)
